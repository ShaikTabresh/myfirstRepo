<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabresh's Calculator</title>
    <style>
        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #a8dadc, #457b9d);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            transition: background-color 0.5s ease;
        }

        .calculator-container {
            background-color: #f1faee;
            border-radius: 25px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            padding: 30px;
            width: 320px;
            position: relative;
            z-index: 10;
            border: 5px solid #1d3557;
        }

        h1 {
            text-align: center;
            color: #e63946;
            margin-bottom: 25px;
            font-size: 2.2em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .calculator-display {
            background-color: #a8dadc;
            color: #1d3557;
            font-size: 2.8em;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: right;
            overflow: hidden;
            white-space: nowrap;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.2);
            font-weight: bold;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
        }

        .calculator-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        .btn {
            background-color: #457b9d;
            color: white;
            border: none;
            padding: 20px 0;
            font-size: 1.8em;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .btn:hover {
            background-color: #e63946;
            transform: translateY(-2px);
            box-shadow: 0 7px 15px rgba(0, 0, 0, 0.3);
        }

        .btn:active {
            transform: translateY(0);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
        }

        .btn.clear {
            background-color: #f77f00;
        }
        .btn.clear:hover {
            background-color: #d66800;
        }

        .btn.operator {
            background-color: #a8dadc;
            color: #1d3557;
        }
        .btn.operator:hover {
            background-color: #e63946;
            color: white;
        }

        .btn.equals {
            grid-column: span 2;
            background-color: #e63946;
            font-size: 2.5em;
        }
        .btn.equals:hover {
            background-color: #d12e3b;
        }
        .btn.zero {
            grid-column: span 2;
        }
        .btn.delete {
            background-color: #c70039;
            font-size: 1.5em;
            padding-top: 23px;
            padding-bottom: 17px;
        }
        .btn.delete:hover {
            background-color: #a8002f;
        }
        .confetti-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #e63946;
            opacity: 0;
            animation: fade-out 2s forwards, fall 2s forwards;
        }
        .confetti:nth-child(2n) { background-color: #a8dadc; }
        .confetti:nth-child(3n) { background-color: #457b9d; }
        .confetti:nth-child(4n) { background-color: #f1faee; }
        .confetti:nth-child(5n) { background-color: #f77f00; }
        @keyframes fall {
            0% {
                transform: translateY(-10vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
        @keyframes fade-out {
            0% { opacity: 1; }
            50% { opacity: 1; }
            100% { opacity: 0; }
        }
        body.bg-add { background: linear-gradient(135deg, #FF6F61, #DE4B4B); }
        body.bg-subtract { background: linear-gradient(135deg, #6B7B8E, #4B5B6E); }
        body.bg-multiply { background: linear-gradient(135deg, #FFD700, #DAA520); }
        body.bg-divide { background: linear-gradient(135deg, #C0C0C0, #A9A9A9); }
    </style>
</head>
<body>
    <audio id="boingSound" src="https://www.soundjay.com/misc/sounds/boing_1.mp3" preload="auto"></audio>
    <audio id="chimeSound" src="https://www.soundjay.com/misc/sounds/chime_3.mp3" preload="auto"></audio>
    <audio id="magicSound" src="https://www.soundjay.com/misc/sounds/magic_wand.mp3" preload="auto"></audio>
    <audio id="gongSound" src="https://www.soundjay.com/misc/sounds/gong-sound-effect-1.mp3" preload="auto"></audio>
    <div class="confetti-container" id="confetti-container"></div>
    <div class="calculator-container">
        <h1>Whimsical Calculator 🔮</h1>
        <div class="calculator-display" id="display">0</div>
        <div class="calculator-buttons">
            <button class="btn clear" data-action="clear">C</button>
            <button class="btn operator" data-action="divide">÷</button>
            <button class="btn operator" data-action="multiply">×</button>
            <button class="btn delete" data-action="delete">DEL</button>
            <button class="btn number">7</button>
            <button class="btn number">8</button>
            <button class="btn number">9</button>
            <button class="btn operator" data-action="subtract">-</button>
            <button class="btn number">4</button>
            <button class="btn number">5</button>
            <button class="btn number">6</button>
            <button class="btn operator" data-action="add">+</button>
            <button class="btn number">1</button>
            <button class="btn number">2</button>
            <button class="btn number">3</button>
            <button class="btn equals" data-action="calculate">=</button>
            <button class="btn number zero">0</button>
            <button class="btn decimal" data-action="decimal">.</button>
        </div>
    </div>
    <script>
        const display = document.getElementById('display');
        const buttons = document.querySelectorAll('.btn');
        const confettiContainer = document.getElementById('confetti-container');
        const boingSound = document.getElementById('boingSound');
        const chimeSound = document.getElementById('chimeSound');
        const magicSound = document.getElementById('magicSound');
        const gongSound = document.getElementById('gongSound');
        let currentInput = '0';
        let previousInput = '';
        let operator = null;
        let awaitingNextInput = false;
        const funnyMessages = [
            "Abracadabra! ✨",
            "Vo! The answer is...",
            "yoo, you've got it!",
            "Math wizardry complete!",
            "Behold, the number! 🧐",
            "It's... drumroll please... ",
            "Calculated with cosmic dust!",
            "Your destiny number is: "
        ];
        const luckyNumbers = [1,3,7, 13,18, 42, 69, 101, 314, 777];
        function updateDisplay(value) {
            display.textContent = value;
            if (value.length > 10 && value.length <= 15) {
                display.style.fontSize = '2.2em';
            } else if (value.length > 15) {
                display.style.fontSize = '1.8em';
            } else {
                display.style.fontSize = '2.8em';
            }
        }
        function playRandomSound() {
            const sounds = [boingSound, chimeSound, magicSound];
            const randomIndex = Math.floor(Math.random() * sounds.length);
            sounds[randomIndex].currentTime = 0;
            sounds[randomIndex].play();
        }
        function triggerConfetti() {
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.top = Math.random() * -10 + 'vh';
                confetti.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 50%)`;
                confetti.style.animationDelay = `${Math.random() * 0.5}s`;
                confettiContainer.appendChild(confetti);

                confetti.addEventListener('animationend', () => {
                    confetti.remove();
                });
            }
        }

        function changeBackground(operation) {
            document.body.classList.remove('bg-add', 'bg-subtract', 'bg-multiply', 'bg-divide');
            if (operation) {
                document.body.classList.add(`bg-${operation}`);
            }
        }
        buttons.forEach(button => {
            button.addEventListener('click', () => {
                const buttonValue = button.textContent;
                const action = button.dataset.action;

                if (!['clear', 'calculate'].includes(action)) {
                    if (Math.random() < 0.3) {
                        playRandomSound();
                    }
                }
                if (button.classList.contains('number') || action === 'decimal') {
                    if (awaitingNextInput) {
                        currentInput = buttonValue === '.' ? '0.' : buttonValue;
                        awaitingNextInput = false;
                    } else {
                        if (buttonValue === '.' && currentInput.includes('.')) return;
                        if (currentInput === '0' && buttonValue !== '.') {
                            currentInput = buttonValue;
                        } else {
                            currentInput += buttonValue;
                        }
                    }
                    updateDisplay(currentInput);
                } else if (button.classList.contains('operator')) {
                    if (previousInput && operator && !awaitingNextInput) {
                        calculate();
                    }
                    previousInput = currentInput;
                    operator = action;
                    awaitingNextInput = true;
                    changeBackground(action);
                } else if (action === 'clear') {
                    currentInput = '0';
                    previousInput = '';
                    operator = null;
                    awaitingNextInput = false;
                    updateDisplay(currentInput);
                    changeBackground(null);
                    gongSound.currentTime = 0;
                    gongSound.play();
                } else if (action === 'delete') {
                    if (currentInput.length > 1) {
                        currentInput = currentInput.slice(0, -1);
                    } else {
                        currentInput = '0';
                    }
                    updateDisplay(currentInput);
                } else if (action === 'calculate') {
                    calculate();
                    gongSound.currentTime = 0;
                    gongSound.play();
                }
            });
        });
        function calculate() {
            let result;
            const prev = parseFloat(previousInput);
            const current = parseFloat(currentInput);
            if (isNaN(prev) || isNaN(current)) return;
            switch (operator) {
                case 'add':
                    result = prev + current;
                    break;
                case 'subtract':
                    result = prev - current;
                    break;
                case 'multiply':
                    result = prev * current;
                    break;
                case 'divide':
                    if (current === 0) {
                        updateDisplay("Can't divide by zero, silly!");
                        currentInput = '0';
                        previousInput = '';
                        operator = null;
                        awaitingNextInput = true;
                        changeBackground(null);
                        return;
                    }
                    result = prev / current;
                    break;
                default:
                    return;
            }
            result = parseFloat(result.toFixed(10));
            const useFunnyMessage = Math.random() < 0.5;
            let displayResult = result.toString();
            if (useFunnyMessage) {
                const randomIndex = Math.floor(Math.random() * funnyMessages.length);
                displayResult = funnyMessages[randomIndex] + displayResult;
            }
            if (luckyNumbers.includes(Math.round(result)) || luckyNumbers.includes(Math.abs(Math.round(result)))) {
                triggerConfetti();
                magicSound.currentTime = 0;
                magicSound.play();
                displayResult = "WOW! A Lucky Number! " + displayResult;
            }
            currentInput = result.toString();
            previousInput = '';
            operator = null;
            awaitingNextInput = true;
            updateDisplay(displayResult);
            changeBackground(null);
        }
        updateDisplay(currentInput);
    </script>
</body>
</html>